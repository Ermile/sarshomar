{%extends display.question%}




{%block pageContent%}

{%if dataTable and not showChart%}

  {{block('htmlTable')}}

{%else%}
<form method="get" action="{{url.this}}/question">

  <input type="hidden" name="id" value="{{requestGET.id}}">
  <input type="hidden" name="questionid" value="{{requestGET.questionid}}">

  <div class="f">
    <div class="c s12 pRa5">
        {{block('iQuestion2')}}
    </div>
    <div class="c s12 pRa5">
        {{block('iQuestion3')}}
    </div>
    <div class="cauto s12">
      <label>&nbsp;</label>
      <button class="btn block primary">{%trans "Run"%}</button>
    </div>
  </div>
</form>

   {%if showAdvanceChart%}
      <div class="chart x5 mB20" id="chartdiv" >
     </div>
     {{block('tableAdvanceChart')}}
   {%else%}

     <div class="chart x4 mB20" id="chartdiv" >
     </div>
      {{block('htmlTableRow')}}
   {%endif%}

{%endif%}

{%endblock%}



{%block foot_js%}
{%if showChart%}
<script type="text/javascript">
  {%include 'content_a/report/question/chart.js'%}
</script>
{%elseif showAdvanceChart%}
<script type="text/javascript">
  {%include 'content_a/report/question/advancechart.js'%}
</script>
{%endif%}
{%endblock%}







{%block iQuestion2%}


  <label for="question2">{%trans "Question"%}</label>
  <select name="question2" class="ui dropdown select">
    <option value=""><i>{%trans "Please select one item"%}</i></option>
    <option value="0"><i>{%trans "Whitout question"%}</i></option>
    {%for key, value in questionList%}
    {%if value.id != requestGET.questionid%}
    <option value="{{value.id}}" {%if value.id == requestGET.question2%} selected {%endif%}>{{value.title}}</option>
    {%endif%}
    {%endfor%}
  </select>

{%endblock%}


{%block iQuestion3%}


  <label for="question3">{%trans "Question"%}</label>
  <select name="question3" class="ui dropdown select">
    <option value=""><i>{%trans "Please select one item"%}</i></option>
    <option value="0"><i>{%trans "Whitout question"%}</i></option>
    {%for key, value in questionList%}
    {%if value.id != requestGET.questionid%}
    <option value="{{value.id}}" {%if value.id == requestGET.question3%} selected {%endif%}>{{value.title}}</option>
    {%endif%}
    {%endfor%}
  </select>

{%endblock%}



{%block htmlTableRow%}


  <table class="tbl1 v1 cbox fs12 ">
    <thead class="primary fs09">
      <tr>
        <th title='{%trans "Click to sort"%}' data-sort='{{sortLink.answer.order}}'><a href="{{sortLink.answer.link}}">{%trans "Answer"%}</a> </th>
        <th title='{%trans "Click to sort"%}' data-sort='{{sortLink.value.order}}'><a href="{{sortLink.value.link}}">{%trans "Count"%}</a></th>
        {%if false%}<th data-sort='{{sortLink.value_all.order}}'><a href="{{sortLink.value_all.link}}">{%trans "Incomplete survey"%}</a></th>{%endif%}
      </tr>
    </thead>
    <tbody>
      {%for key, value in tableRow.categories%}
      <tr>
          <td>{{value}}</td>
          <td>{{tableRow['value'][key] | fitNumber}}</td>
          {%if false%}<td>{{tableRow['value_all'][key] | fitNumber}}</td>{%endif%}
      </tr>
      {%endfor%}

    </tbody>
  </table>
  {%include display.pagination%}

{%endblock%}


{%block htmlTable%}


  <table class="tbl1 v1 cbox fs12">
    <thead class="primary fs09">
      <tr>

        <th>{%trans "Answers"%}</th>
      </tr>
    </thead>

    <tbody>
      {%for key, value in dataTable%}
      <tr>
        <td>{{value.text}}</td>
      </tr>
      {%endfor%}
    </tbody>
  </table>
  {%include display.pagination%}

{%endblock%}


{%block tableAdvanceChart%}

  <table class="tbl1 v1 cbox fs12">
    <thead class="primary fs09">
      <tr>
        {%for key, value in advanceChart.question%}
        <th data-sort="{{sortLink[key]['sort']}}">{{value}}</th>
        {%endfor%}
        <th data-sort="{{sortLink['count']['sort']}}">{%trans "Count"%}</th>
      </tr>
    </thead>

    <tbody>
      {%for key, value in advanceChart.table%}
      <tr>
        {%for k, v in value%}
          <td>{{v | fitNumber}}</td>
        {%endfor%}
      </tr>
      {%endfor%}
    </tbody>
  </table>


{%endblock%}
